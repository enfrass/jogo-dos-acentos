<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jogo dos Acentos</title>
  <style>
  #gameContent {
    display: none;
  }
  body {
    font-family: 'Courier New', monospace;
    background-color: #3a3a3c;
    text-align: center;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 40px;
  }

  .letter-boxes {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 20px;
    max-width: 90vw;
  }

  .letter-box {
    width: 60px;
    height: 60px;
    font-size: 32px;
    text-align: center;
    line-height: 60px;
    text-transform: uppercase;
    background-color: #121213;
    border: 2px solid #3a3a3c;
    border-radius: 5px;
    color: white;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }

  .letter-box.selected {
    border: 5px solid #6a6b6c;
  }

  .correct {
    background-color: #538d4e !important;
    border-color: #538d4e !important;
  }

  .incorrect-accent {
    background-color: #b59f3b !important;
    border-color: #b59f3b !important;
  }

  .wrong {
    background-color: #ff0000 !important;
    border-color: #3a3a3c !important;
    color: #787c7e;
  }

  .accent-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
    margin-bottom: 20px;
  }

  .accent-buttons button,
  button {
    padding: 10px 15px;
    border: 5px solid #565758;
    border-radius: 5px;
    background-color: #565758;
    color: white;
    font-size: 18px;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }

  button:hover {
    border: 5px solid #757778;
  }

  .feedback {
    text-align: center;
    font-weight: bold;
    margin-top: 15px;
    font-size: 22px;
  }

  .score {
    text-align: center;
    margin-top: 20px;
  }

  #finalMessage {
    display: none;
    text-align: center;
    font-size: 24px;
    font-weight: bold;
    margin-top: 20px;
    padding: 20px;
    background: white;
    border-radius: 10px;
    animation: dropIn 0.6s ease-out;
    color: black;
  }

  #popup {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: #ff0000;
    color: white;
    padding: 10px 20px;
    border-radius: 10px;
    font-weight: bold;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 999;
  }

  #popup.show {
    display: block;
    opacity: 1;
  }

  @keyframes dropIn {
    from { transform: translateY(-200px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

@media (max-width: 480px) {
  .letter-box {
    width: 42px;
    height: 42px;
    font-size: 22px;
    line-height: 42px;
  }

  .accent-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
    margin-bottom: 20px;
  }

  .accent-buttons button {
    font-size: 16px;
    padding: 8px 10px;
    min-width: 48px;
    margin: 4px;
  }

  .accent-buttons,
  #telaInicial button {
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: center;
  }

  #telaInicial button {
    margin: 5px;
    min-width: 100px;
  }

  body {
    padding: 20px;
  }
}


/* Corrige layout de bot√µes na tela inicial */
#telaInicial button {
  margin: 5px;
  min-width: 120px;
}
@keyframes fadeInRed {
    0% { opacity: 0; }
    30% { opacity: 0.2; }
    60% { opacity: 0.5; }
    85% { opacity: 0.8; }
    100% { opacity: 1; }
  }

  #bondShot {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #a00000;
    z-index: 10000;
    opacity: 0;
  }
</style>
</head>
<body>
  <div id="telaInicial" style="text-align: center;">
    <h2>üéØ Bem-vindo ao Jogo dos Acentos!</h2>
    <p>Voc√™ vai encarar 10 palavras ‚Äì sua miss√£o √© acentu√°-las corretamente! </p>
    <p>Cada acento vale pontos, e cada erro... bem, √© uma chance para aprender!</p>
    <p>obs: cedilha (√ß) tamb√©m conta!</p>
    <ul style="text-align:left; max-width: 600px; margin: auto;">
      <li><span style="color:#538d4e; font-weight:bold;">Verde</span>: Letra correta com acento correto</li>
      <li><span style="color:#b59f3b; font-weight:bold;">Amarelo</span>: Letra correta sem acento</li>
      <li><span style="color:#ff0000; font-weight:bold;">Vermelho</span>: Acento incorreto</li>
    </ul>
      <p>‚ö† Este site √© melhor visualizado em um computador. ‚ö†</p>
    <p>Escolha a dificuldade:</p>
    <button onclick="iniciarComDificuldade('facil')">F√°cil</button>
    <button onclick="iniciarComDificuldade('normal')">Normal</button>
    <button onclick="iniciarComDificuldade('dificil')">Dif√≠cil</button>
    <button onclick="mostrarAvisoImpossivel()">Imposs√≠vel</button>

  </div>
  <div id="avisoImpossivel" style="display:none; text-align:center; background-color:#2a2a2a; padding:30px; border-radius:10px; margin-bottom: 20px;">
  <h2>‚ö†Ô∏è Modo Imposs√≠vel</h2>
  <p>Nesse modo, as palavras estar√£o <strong>sem acento</strong> e <strong>com as letras embaralhadas</strong>.</p>
  <p>Voc√™ precisar√° descobrir a palavra original e aplicar os acentos corretamente.</p>
  <p>Essa √© a dificuldade mais dif√≠cil do jogo. Tem certeza que deseja come√ßar? </p>
  <button onclick="iniciarComDificuldade('impossivel')">‚úÖ Sim, come√ßar</button>
    <button onclick="voltarTelaInicial()" style="display:none; margin-top: 10px;" id='voltarInicio'>üîô Voltar √† tela inicial</button>
</div>


  <div id="gameContent">
    <div id="inputImpossivel" style="display:none; margin-top: 20px;">
  <label for="campoDigitado">Digite a palavra correta:</label><br>
      <p>       </p>
  <input type="text" id="campoDigitado" style="padding: 10px; font-size: 18px; text-transform: lowercase;">
</div>
  <h1>Jogo dos Acentos</h1>
  <div id="popup" class="popup">N√£o √© poss√≠vel adicionar "√ß" na letra "<span id="letra-invalida"></span>"</div>
  <div class="word" id="word">carregando...</div>
  <div class="letter-boxes" id="letterBoxes"></div>
  <div class="accent-buttons" id="accent-buttons">
     <button onclick="applyAccent('¬¥')">¬¥</button>
      <button onclick="applyAccent('`')">`</button>
      <button onclick="applyAccent('^')">^</button>
      <button onclick="applyAccent('~')">~</button>
      <button onclick="applyAccent('√ß')">√ß</button>
      <button onclick="removeAccent()">remover todos os acentos</button>
    </div>

    <div style="text-align: center;">
      <button onclick="checkAnswer()" id="checkButton">Verificar</button>
      <button onclick="giveUp()" id="giveUpButton" style="display:none">Desistir</button>
      <button onclick="nextWord()" id="nextButton" style="display:none">Pr√≥xima Palavra</button>
    </div>

    <div class="feedback" id="feedback"></div>
    <div class="score" id="score"></div>
    <div id="finalMessage"></div>
    <button onclick="voltarTelaInicial()" id="botaoTelaInicial" style="display:none; margin-top: 10px;">‚¨ÖÔ∏è Voltar para a Tela Inicial</button>
    <button id="recomecarButton" onclick="iniciarJogo()" style="display:none; margin-top: 20px; font-size: 20px;">üîÑ Recome√ßar</button>
  </div>
  <audio id="bondTheme" src="https://www.myinstants.com/media/sounds/007-james-bond-theme_TZToRFY.mp3"></audio>
  <div id="bondEffect" style="display:none; opacity: 0; pointer-events: none; position:fixed; top:0; left:0; width:100%; height:100%; background:black; z-index:9999; display:flex; align-items:center; justify-content:center;">
    <img src="https://thegraphicalcloud.files.wordpress.com/2014/10/gunbarrel-01.png" style="width:100%; height:100%; object-fit:cover;">
  </div>
  <div id="bondShot" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#a00000; z-index:9998; opacity: 0;"></div>
    <audio id="clickSound" src="https://www.soundjay.com/buttons/sounds/button-37a.mp3"></audio>
  <audio id="clickSound1" src="https://www.soundjay.com/buttons/sounds/button-38.mp3"></audio>
  <audio id="clickSound2" src="https://www.myinstants.com/media/sounds/correcto_Xgyp04B.mp3"></audio>
  <audio id="clickSound3" src="https://www.soundjay.com/misc/sounds/fail-trombone-03.mp3"></audio>
  <audio id="clickSound5/5" src="https://www.myinstants.com/media/sounds/well-done-follow.mp3"></audio>
  <audio id="clickSound4/5" src="https://www.myinstants.com/media/sounds/success-chime.mp3"></audio>
  <audio id="clickSound0/5" src="https://www.myinstants.com/media/sounds/failure-sound.mp3"></audio>
  <audio id="clickSoundError" src="https://www.myinstants.com/media/sounds/app-error.mp3"></audio>

  <script>
    let todasPalavras = [];
    let palavras = [];
    let dificuldadeSelecionada = 'normal';

    function mostrarAvisoImpossivel() {
  document.getElementById('telaInicial').style.display = 'none';
  document.getElementById('avisoImpossivel').style.display = 'block';
  document.getElementById('voltarInicio').style.display = 'inline-block';
}

    function voltarTelaInicial() {
    document.getElementById('telaInicial').style.display = 'block';
    document.getElementById('gameContent').style.display = 'none';
    document.getElementById('finalMessage').style.display = 'none';
    document.getElementById('recomecarButton').style.display = 'none';
    document.getElementById('voltarInicio').style.display = 'none';
    document.getElementById('botaoTelaInicial').style.display = 'none';
    document.getElementById('avisoImpossivel').style.display = 'none';
    document.getElementById('bondTheme').style.display = 'none';


  // limpa conte√∫do visual de jogo
  document.getElementById('letterBoxes').innerHTML = '';
  document.getElementById('word').textContent = '';
  document.getElementById('feedback').textContent = '';
    }

    function iniciarComDificuldade(dificuldade) {
  dificuldadeSelecionada = dificuldade;
  document.getElementById('telaInicial').style.display = 'none';
  document.getElementById('avisoImpossivel').style.display = 'none';
  document.getElementById('gameContent').style.display = 'block';
  iniciarJogo();
    }

    function filtrarPorDificuldade() {
      if (dificuldadeSelecionada === 'impossivel') {
        document.getElementById('avisoImpossivel').style.display = 'none';
        return todasPalavras.map(p => ({
          ...p,
          sem: embaralhar(p.sem.split('')).join('')
        }));
      }

      if (dificuldadeSelecionada === 'facil') {
        return todasPalavras.filter(p => p.sem.length <= 4);
      }

      if (dificuldadeSelecionada === 'normal') {
        return todasPalavras.filter(p => p.sem.length >= 5 && p.sem.length <= 6);
      }

      if (dificuldadeSelecionada === 'dificil') {
        return todasPalavras.filter(p => p.sem.length >= 7);
      }

      return todasPalavras;
    }


    function embaralhar(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }


    fetch('palavras_portugues.json')
            .then(res => res.json())
            .then(data => {
              todasPalavras = data;
              iniciarJogo();
            });

    let current = 0;
    let acertos = 0;
    let selectedIndex = null;
    let respostaConfirmada = false;
    let errouPrimeiro = false;

    function iniciarJogo() {
  document.getElementById('inputImpossivel').style.display = 'none';
      palavras = filtrarPorDificuldade().sort(() => Math.random() - 0.5).slice(0, 10);
      current = 0;
      acertos = 0;
      document.getElementById('letterBoxes').style.display = 'flex';
      document.getElementById('accent-buttons').style.display = 'flex';
      document.getElementById('feedback').style.display = 'block';
      document.getElementById('finalMessage').style.display = 'none';
      document.getElementById('recomecarButton').style.display = 'none';
      loadWord();
    }

    function showPopup(texto) {
      const popup = document.getElementById('popup');
      popup.textContent = texto;
      popup.classList.add('show');
      setTimeout(() => {
        popup.classList.remove('show');
        setTimeout(() => popup.style.display = 'none', 300);
      }, 1500);
      popup.style.display = 'block';
    }

    function loadWord() {
     if (current >= palavras.length) return showFinalMessage();
  respostaConfirmada = false;
  errouPrimeiro = false;
  const word = palavras[current].sem;
  const container = document.getElementById('letterBoxes');
  container.innerHTML = '';

  if (dificuldadeSelecionada === 'impossivel') {
    document.getElementById('word').style.marginBottom = '16px'
    document.getElementById('word').style.fontSize = '42px';
    document.getElementById('word').textContent = `Palavra ${current + 1}: ${word.toUpperCase()}`;
    document.getElementById('letterBoxes').style.display = 'none';
    document.getElementById('accent-buttons').style.display = 'none';
    document.getElementById('inputImpossivel').style.display = 'block';
    document.getElementById('campoDigitado').value = '';
  } else {
    for (let i = 0; i < word.length; i++) {
      const span = document.createElement('div');
      span.className = 'letter-box';
      span.textContent = word[i];
      span.addEventListener('click', () => selectLetter(i));
      container.appendChild(span);
    }
    document.getElementById('word').textContent = `Palavra ${current + 1}`;
    document.getElementById('letterBoxes').style.display = 'flex';
    document.getElementById('accent-buttons').style.display = 'flex';
    document.getElementById('inputImpossivel').style.display = 'none';
  }

  document.getElementById('feedback').textContent = "";
  document.getElementById('score').textContent = "";
  document.getElementById('checkButton').style.display = 'inline-block';
  document.getElementById('nextButton').style.display = 'none';
  document.getElementById('giveUpButton').style.display = 'none';
}

    function selectLetter(index) {
      document.querySelectorAll('.letter-box').forEach(box => box.classList.remove('selected'));
      document.querySelectorAll('.letter-box')[index].classList.add('selected');
      document.getElementById('clickSound').play();
      selectedIndex = index;
    }

    function applyAccent(acento) {
      if (selectedIndex === null) return;
      const boxes = document.querySelectorAll('.letter-box');
      let letra = boxes[selectedIndex].textContent;
      const mapa = {
        'a': {'¬¥': '√°', '`': '√†', '^': '√¢', '~': '√£'},
        'e': {'¬¥': '√©', '`': '√®', '^': '√™'},
        'i': {'¬¥': '√≠', '`': '√¨', '^': '√Æ'},
        'o': {'¬¥': '√≥', '`': '√≤', '^': '√¥', '~': '√µ'},
        'u': {'¬¥': '√∫', '`': '√π', '^': '√ª'},
        'c': {'√ß': '√ß'}
      };

      // Converte letra acentuada de volta para base, se necess√°rio
      for (const base in mapa) {
        for (const ac in mapa[base]) {
          if (mapa[base][ac] === letra) letra = base;
        }
      }

      const lower = letra.toLowerCase();
      const isVogal = ['a', 'e', 'i', 'o', 'u'].includes(lower);

// ‚ùó Consoantes n√£o podem receber acento
      if (!isVogal && lower !== 'c') {
        showPopup(`A letra "${letra}" n√£o pode receber acento.`);
        return;
      }

// ‚ùó Til s√≥ pode em 'a' ou 'o'
      if (acento === '~' && !['a', 'o'].includes(lower)) {
        showPopup(`O til (~) s√≥ pode ser usado nas letras "a" ou "o".`);
        return;
      }

// ‚ùó √ß s√≥ pode em 'c'
      if (acento === '√ß' && lower !== 'c') {
        showPopup(`N√£o √© poss√≠vel adicionar "√ß" na letra "${letra}"`);
        return;
      }


      if (mapa[lower] && mapa[lower][acento]) {
        boxes[selectedIndex].textContent = mapa[lower][acento];
      }

      document.getElementById('clickSound1').play();
    }

    function removeAccent() {
      const mapa = {
        '√°': 'a', '√†': 'a', '√¢': 'a', '√£': 'a',
        '√©': 'e', '√®': 'e', '√™': 'e',
        '√≠': 'i', '√¨': 'i', '√Æ': 'i',
        '√≥': 'o', '√≤': 'o', '√¥': 'o', '√µ': 'o',
        '√∫': 'u', '√π': 'u', '√ª': 'u',
        '√ß': 'c'
      };

      const boxes = document.querySelectorAll('.letter-box');

      // Remove o acento de todas as letras
      boxes.forEach((box, index) => {
        const letra = box.textContent;
        box.textContent = mapa[letra] || letra;
      });

      document.getElementById('clickSound').play();
      showPopup("Todos os acentos foram removidos");
    }

    function getCurrentResposta() {
  if (dificuldadeSelecionada === 'impossivel') {
    return document.getElementById('campoDigitado').value.toLowerCase();
  }
  return Array.from(document.querySelectorAll('.letter-box')).map(e => e.textContent).join('').toLowerCase();
}

    function clearColors() {
      document.querySelectorAll('.letter-box').forEach(box => {
        box.classList.remove('correct', 'incorrect-accent', 'wrong');
      });
    }

    function checkAnswer() {
  if (respostaConfirmada) return;
  clearColors();
  const resposta = getCurrentResposta();
  const corretaArray = Array.isArray(palavras[current].com) ? palavras[current].com : [palavras[current].com];

  if (dificuldadeSelecionada === 'impossivel') {
    if (corretaArray.some(c => c.toLowerCase() === resposta)) {
      document.getElementById('feedback').textContent = "‚úÖ Correto!";
      if (!errouPrimeiro) acertos++;
      document.getElementById('clickSound2').play();
      document.getElementById('nextButton').style.display = 'inline-block';
      document.getElementById('checkButton').style.display = 'none';
      document.getElementById('giveUpButton').style.display = 'none';
      respostaConfirmada = true;
    } else {
      document.getElementById('feedback').textContent = "‚ùå Tente novamente ou clique em Desistir.";
      document.getElementById('giveUpButton').style.display = 'inline-block';
      errouPrimeiro = true;
      document.getElementById('clickSoundError').play();
    }
    return;
  }

 const boxes = document.querySelectorAll('.letter-box');
  for (let i = 0; i < boxes.length; i++) {
    const respostaChar = resposta[i];
    const corretaChars = corretaArray.map(c => c[i]);
    const semAcentoChar = palavras[current].sem[i];

    if (corretaChars.includes(respostaChar)) {
      boxes[i].classList.add('correct');
    } else if (corretaChars.some(c => c?.toLowerCase() === respostaChar?.toLowerCase())) {
      boxes[i].classList.add('incorrect-accent');
    } else if (respostaChar?.toLowerCase() === semAcentoChar) {
      boxes[i].classList.add('incorrect-accent');
    } else {
      boxes[i].classList.add('wrong');
    }
  }

  if (corretaArray.some(c => c.toLowerCase() === resposta)) {
    document.getElementById('feedback').textContent = "‚úÖ Correto!";
    if (!errouPrimeiro) acertos++;
    document.getElementById('clickSound2').play();
    document.getElementById('nextButton').style.display = 'inline-block';
    document.getElementById('checkButton').style.display = 'none';
    document.getElementById('giveUpButton').style.display = 'none';
    respostaConfirmada = true;
  } else {
    document.getElementById('feedback').textContent = "‚ùå Tente novamente ou clique em Desistir.";
    document.getElementById('giveUpButton').style.display = 'inline-block';
    errouPrimeiro = true;
    document.getElementById('clickSoundError').play();
  }
}
    function giveUp() {
      clearColors();
      const corretaArray = Array.isArray(palavras[current].com) ? palavras[current].com : [palavras[current].com];
      const correta = corretaArray[0];
      const boxes = document.querySelectorAll('.letter-box');
      const resposta = getCurrentResposta();

      for (let i = 0; i < boxes.length; i++) {
        if (resposta[i] === correta[i]) {
          boxes[i].classList.add('correct');
        } else {
          boxes[i].classList.add('wrong');
        }
      }

      document.getElementById('feedback').innerHTML = `Voc√™ errou!! o correto √©: <strong>${corretaArray.join(" ou ")}</strong><br>Regra: ${palavras[current].regra}`;
      document.getElementById('clickSound3').play();
      document.getElementById('nextButton').style.display = 'inline-block';
      document.getElementById('giveUpButton').style.display = 'none';
      document.getElementById('checkButton').style.display = 'none';
      respostaConfirmada = true;
    }

    function nextWord() {
      current++;
      selectedIndex = null;
      loadWord();
    }

function showFinalMessage() {
  document.getElementById('letterBoxes').style.display = 'none';
  document.getElementById('accent-buttons').style.display = 'none';
  document.getElementById('checkButton').style.display = 'none';
  document.getElementById('nextButton').style.display = 'none';
  document.getElementById('giveUpButton').style.display = 'none';
  document.getElementById('feedback').style.display = 'none';
  document.getElementById('word').textContent = "Fim de jogo!";

  const score = acertos / palavras.length;
  let mensagemFinal;
  if (score === 1) {
    mensagemFinal = "Parab√©ns, foi perfeito!";
    document.getElementById('clickSound5/5').play();
  } else if (score >= 0.6) {
    mensagemFinal = "Voc√™ foi bem, mas precisa estudar mais!";
    document.getElementById('clickSound4/5').play();
  } else {
    mensagemFinal = "N√£o desanime, que tal tentar novamente?";
    document.getElementById('clickSound0/5').play();
  }

  const resumo = `\nVoc√™ acertou ${acertos}/${palavras.length}`;
  document.getElementById('finalMessage').textContent = mensagemFinal + resumo;
  document.getElementById('finalMessage').style.display = 'block';
  document.getElementById('recomecarButton').style.display = 'inline-block';
  document.getElementById('botaoTelaInicial').style.display = 'inline-block';
}

// document.getElementById('voltarInicio').style.display = 'inline-block';

    document.addEventListener('keydown', function (event) {
      if (event.key === 'Enter') {
        if (document.getElementById('checkButton').style.display !== 'none') {
          checkAnswer();
        } else if (document.getElementById('nextButton').style.display !== 'none') {
          nextWord();
        }
      }
    });
    let bondSequence = ['j', 'a', 'm', 'e', 's', 'b', 'o', 'n', 'd'];
let bondIndex = 0;

document.addEventListener('keydown', function (e) {
  if (e.target.tagName.toLowerCase() === 'input') return;
  if (e.key.toLowerCase() === bondSequence[bondIndex]) {
    bondIndex++;
    if (bondIndex === bondSequence.length) {
      bondIndex = 0;
      const audio = document.getElementById('bondTheme');
      if (audio) {
        document.getElementById('bondEffect').style.display = 'none';
        audio.play();
      }
    }
  } else {
    bondIndex = 0;
  }
});
</script>
</body>
</html>
